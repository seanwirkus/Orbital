<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Orbital - Organic Chemistry Simulator</title>
    <link rel="stylesheet" href="src/css/styles.css">
</head>
<body>
    <div class="app-container">
        <header class="header">
            <div class="header-content">
                <h1>‚öõÔ∏è Orbital</h1>
                <p class="subtitle">All-in-One Organic Chemistry Simulator</p>
            </div>
        </header>

        <div class="main-content">
            <aside class="sidebar">
                <div class="tool-panel">
                    <h2 class="sidebar-title">Drawing Kit</h2>

                    <section class="tool-section">
                        <h3>Elements</h3>
                        <div class="element-grid">
                            <button class="element-btn active" data-element="C">C</button>
                            <button class="element-btn" data-element="H">H</button>
                            <button class="element-btn" data-element="N">N</button>
                            <button class="element-btn" data-element="O">O</button>
                            <button class="element-btn" data-element="F">F</button>
                            <button class="element-btn" data-element="Cl">Cl</button>
                            <button class="element-btn" data-element="Br">Br</button>
                            <button class="element-btn" data-element="I">I</button>
                            <button class="element-btn" data-element="S">S</button>
                            <button class="element-btn" data-element="P">P</button>
                            <button class="element-btn" data-element="B">B</button>
                            <button class="element-btn" data-element="Si">Si</button>
                            <button class="element-btn" data-element="Se">Se</button>
                            <button class="element-btn" data-element="As">As</button>
                            <button class="element-btn" data-element="Li">Li</button>
                            <button class="element-btn" data-element="Na">Na</button>
                            <button class="element-btn" data-element="K">K</button>
                            <button class="element-btn" data-element="Mg">Mg</button>
                            <button class="element-btn" data-element="Ca">Ca</button>
                            <button class="element-btn" data-element="Al">Al</button>
                            <button class="element-btn" data-element="Fe">Fe</button>
                            <button class="element-btn" data-element="Cu">Cu</button>
                            <button class="element-btn" data-element="Zn">Zn</button>
                        </div>
                    </section>

                    <section class="tool-section">
                        <h3>Bonds</h3>
                        <div class="bond-controls">
                            <button class="bond-btn active" data-bond="1" id="sidebar-bond-single">‚îÅ</button>
                            <button class="bond-btn" data-bond="2" id="sidebar-bond-double">‚ïê</button>
                            <button class="bond-btn" data-bond="3" id="sidebar-bond-triple">‚â°</button>
                        </div>
                    </section>

                    <section class="tool-section">
                        <h3>Templates</h3>
                        <div class="template-grid">
                            <button class="template-btn" data-template="benzene" id="template-benzene">Benzene</button>
                            <button class="template-btn" data-template="cyclohexane" id="template-cyclohexane">Cyclohexane</button>
                            <button class="template-btn" data-template="cyclopentane" id="template-cyclopentane">Cyclopentane</button>
                        </div>
                    </section>

                    <section class="tool-section">
                        <h3>Display</h3>
                        <label class="checkbox-label">
                            <input type="checkbox" id="show-implicit-h" checked>
                            <span>Implicit hydrogens</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="show-lone-pairs">
                            <span>Lone pairs</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="show-charges">
                            <span>Charges</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="show-hybridization">
                            <span>Hybridization labels</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="show-valence-errors" checked>
                            <span>Valence warnings</span>
                        </label>
                    </section>

                    <section class="tool-section">
                        <h3>Smart helpers</h3>
                        <label class="checkbox-label">
                            <input type="checkbox" id="toggle-smart-layout">
                            <span>Auto layout</span>
                        </label>
                        <button class="ghost-btn" id="add-explicit-h">Add explicit hydrogens</button>
                    </section>

                    <section class="tool-section">
                        <h3>Canvas</h3>
                        <div class="action-buttons">
                            <button class="action-btn" id="auto-organize">ü™Ñ Organize</button>
                            <button class="action-btn" id="clear-canvas">üóëÔ∏è Clear</button>
                        </div>
                    </section>
                </div>
            </aside>

            <main class="work-area">
                <nav class="tab-navigation">
                    <button class="tab-btn active" data-tab="draw" onclick="switchTab('draw')">
                        <span class="tab-icon">‚úèÔ∏è</span>
                        <span class="tab-label">Draw</span>
                    </button>
                    <button class="tab-btn" data-tab="simulate" onclick="switchTab('simulate')">
                        <span class="tab-icon">üß™</span>
                        <span class="tab-label">Simulate</span>
                    </button>
                    <button class="tab-btn" data-tab="mechanisms" onclick="switchTab('mechanisms')">
                        <span class="tab-icon">üìä</span>
                        <span class="tab-label">Mechanisms</span>
                    </button>
                </nav>

                <div class="tab-content">
                    <section id="draw-tab" class="tab-pane active">
                        <div class="drawing-toolbar">
                            <div class="toolbar-group">
                                <span class="toolbar-label">Tools</span>
                                <div class="tool-btn-group">
                                    <button class="tool-btn active" id="tool-atom" title="Place atoms (A)">‚öõÔ∏è Atom</button>
                                    <button class="tool-btn" id="tool-bond" title="Draw bonds (B)">‚îÅ Bond</button>
                                    <button class="tool-btn" id="tool-chain" title="Chain drawing (C)">„Ä∞Ô∏è Chain</button>
                                    <button class="tool-btn" id="tool-erase" title="Erase (E)">üóëÔ∏è Erase</button>
                                </div>
                            </div>
                            <div class="toolbar-group">
                                <span class="toolbar-label">Groups</span>
                                <div class="group-btn-group">
                                    <button class="group-btn" id="group-oh">OH</button>
                                    <button class="group-btn" id="group-nh2">NH‚ÇÇ</button>
                                    <button class="group-btn" id="group-cooh">COOH</button>
                                    <button class="group-btn" id="group-cho">CHO</button>
                                </div>
                            </div>
                            <div class="toolbar-group">
                                <span class="toolbar-label">Options</span>
                                <div class="option-btn-group">
                                    <button class="option-btn active" id="option-snap" title="Snap to angles">üìê Snap</button>
                                    <button class="option-btn active" id="option-preview" title="Ghost preview">üëª Preview</button>
                                </div>
                            </div>
                        </div>

                        <div class="drawing-status-bar" id="drawing-status">
                            <div class="status-pill">
                                <span>Tool</span>
                                <strong id="status-tool">Atom</strong>
                            </div>
                            <div class="status-pill">
                                <span>Element</span>
                                <strong id="status-element">C</strong>
                            </div>
                            <div class="status-pill">
                                <span>Bond</span>
                                <strong id="status-bond">Single</strong>
                            </div>
                            <div class="status-coords" id="status-coords">x:0 ‚Ä¢ y:0</div>
                            <div class="status-message" id="status-message">Click anywhere on the canvas to start drawing.</div>
                        </div>

                        <div class="canvas-container">
                            <div class="canvas-wrapper"><canvas id="molecule-canvas" width="800" height="600"></canvas></div>
                            <aside class="properties-panel">
                                <h3 class="panel-title">Molecule Properties</h3>
                                <div class="properties-card">
                                    <div class="property-item"><span class="property-label">Name</span><span class="property-value" id="mol-name">-</span></div>
                                    <div class="property-item"><span class="property-label">Formula</span><span class="property-value" id="mol-formula">-</span></div>
                                    <div class="property-item"><span class="property-label">MW</span><span class="property-value" id="mol-mw">-</span></div>
                                    <div class="property-item"><span class="property-label">Atoms</span><span class="property-value" id="mol-atoms">0</span></div>
                                </div>
                                <button class="btn-primary" onclick="moveToSimulation()" id="use-in-reaction-btn">Use in reaction</button>
                            </aside>
                        </div>
                    </section>

                    <section id="simulate-tab" class="tab-pane">
                        <div id="reaction-ui-container" class="reaction-ui-wrapper"></div>
                        <div class="learning-section">
                            <div class="learning-header">
                                <h3>üß† Learning Notebook</h3>
                                <p>Capture custom reaction challenges so Orbital can learn alongside you.</p>
                            </div>
                            <form id="learning-form" class="learning-form">
                                <div class="form-group">
                                    <label for="learning-problem">Problem prompt</label>
                                    <textarea id="learning-problem" placeholder="Describe the reaction scenario or exam-style question" required></textarea>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="learning-reagent">Key reagents (optional)</label>
                                        <input type="text" id="learning-reagent" placeholder="e.g., Br‚ÇÇ, hv, peroxide">
                                    </div>
                                    <div class="form-group">
                                        <label for="learning-solution">Expected outcome</label>
                                        <textarea id="learning-solution" placeholder="Summarize the product or transformation" required></textarea>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="learning-insight">Key insight / takeaway</label>
                                    <textarea id="learning-insight" placeholder="What principle should Orbital remember?"></textarea>
                                </div>
                                <button type="submit" class="btn-primary">üíæ Save to notebook</button>
                            </form>
                            <div id="learning-suggestions" class="learning-suggestions"></div>
                            <div id="learning-entries" class="learning-entries"></div>
                        </div>
                    </section>

                    <section id="mechanisms-tab" class="tab-pane">
                        <div class="mechanisms-container">
                            <aside class="mechanisms-sidebar">
                                <div class="search-box">
                                    <input type="text" placeholder="üîç Search mechanisms..." id="mech-search">
                                </div>
                                <div class="mech-category">
                                    <h4>‚ö° Elimination</h4>
                                    <button class="mech-btn" data-mech="e2_elimination">E2 Elimination</button>
                                    <button class="mech-btn" data-mech="e1_elimination">E1 Elimination</button>
                                </div>
                                <div class="mech-category">
                                    <h4>üîÑ Substitution</h4>
                                    <button class="mech-btn" data-mech="sn2_substitution">SN2 Substitution</button>
                                    <button class="mech-btn" data-mech="sn1_substitution">SN1 Substitution</button>
                                </div>
                                <div class="mech-category">
                                    <h4>‚ûï Addition</h4>
                                    <button class="mech-btn" data-mech="electrophilic_addition">Electrophilic Addition</button>
                                </div>
                                <div class="mech-category">
                                    <h4>üî• Oxidation/Reduction</h4>
                                    <button class="mech-btn" data-mech="alcohol_oxidation_primary">1¬∞ Alcohol Oxidation</button>
                                    <button class="mech-btn" data-mech="alcohol_oxidation_secondary">2¬∞ Alcohol Oxidation</button>
                                    <button class="mech-btn" data-mech="carbonyl_reduction">Carbonyl Reduction</button>
                                </div>
                                <div class="mech-category">
                                    <h4>üß¨ Advanced</h4>
                                    <button class="mech-btn" data-mech="aldol_condensation">Aldol Condensation</button>
                                    <button class="mech-btn" data-mech="grob_fragmentation">Grob Fragmentation</button>
                                    <button class="mech-btn" data-mech="ester_hydrolysis_base">Ester Hydrolysis</button>
                                </div>
                            </aside>
                            <section class="mechanism-display-area">
                                <div class="mechanism-header-card">
                                    <div class="mechanism-meta">
                                        <h2 id="mech-title">Select a mechanism to begin</h2>
                                        <div class="mechanism-meta-grid">
                                            <div><span>Type & steps</span><strong id="mechanism-meta-type">‚Äî</strong></div>
                                            <div><span>Reagents</span><strong id="mechanism-meta-reagents">‚Äî</strong></div>
                                            <div><span>Conditions</span><strong id="mechanism-meta-conditions">‚Äî</strong></div>
                                            <div><span>Difficulty</span><strong id="mechanism-meta-difficulty">‚Äî</strong></div>
                                        </div>
                                    </div>
                                    <div class="mechanism-control-stack">
                                        <button class="timeline-btn" id="mechanism-prev-step" disabled>‚óÄ Prev</button>
                                        <input type="range" id="mechanism-step-slider" min="0" max="0" value="0" disabled>
                                        <button class="timeline-btn" id="mechanism-next-step" disabled>Next ‚ñ∂</button>
                                        <button class="timeline-btn accent" id="mechanism-play-pause">Play Timeline</button>
                                        <button class="timeline-btn ghost" id="mechanism-export-svg">Export SVG</button>
                                    </div>
                                </div>
                                <div class="mechanism-stage-label" id="mechanism-stage-label">Awaiting mechanism selection‚Ä¶</div>
                                <div class="mechanism-workspace-body">
                                    <div class="mechanism-canvas-panel">
                                        <div id="mechanism-canvas-container" class="mechanism-canvas">
                                            <p class="placeholder">üëà Choose a mechanism to render the full arrow-pushing animation with intermediates.</p>
                                        </div>
                                    </div>
                                    <div class="mechanism-step-panel">
                                        <div id="mechanism-step-detail" class="step-detail-card">
                                            <p class="mechanism-empty">Step insights will appear here.</p>
                                        </div>
                                        <div class="mechanism-energy-profile" id="mechanism-energy-profile"></div>
                                    </div>
                                </div>
                                <div class="mechanism-timeline-wrapper">
                                    <div class="mechanism-timeline-header">
                                        <h4>Mechanism Timeline</h4>
                                        <p>Click any stage to jump through the reaction progression.</p>
                                    </div>
                                    <div id="mechanism-timeline" class="mechanism-timeline"></div>
                                </div>
                            </section>
                        </div>
                    </section>
                </div>
            </main>
        </div>

        <footer class="footer">
            <p>Orbital v2.0 - All-in-One Chemistry Simulator | <a href="#" onclick="showHelp()">Help</a> | <a href="#" onclick="showAbout()">About</a></p>
        </footer>
    </div>

    <script>
        console.log('üöÄ Orbital HTML loaded');
        window.onerror = function(msg, url, lineNo, columnNo, error) {
            console.error('‚ùå Global error:', msg, 'at', url, ':', lineNo);
            return false;
        };
    </script>
    <script src="src/js/elements.js"></script>
    <script src="src/js/periodic-table-loader.js"></script>
    <script src="src/js/geometry.js"></script>
    <script src="src/js/chemistry-intelligence.js"></script>
    <script src="src/js/smart-chemistry-logic.js"></script>
    <script src="src/js/smart-drawing.js"></script>
    <script src="src/js/clipboard.js"></script>
    <script src="src/js/molecule.js"></script>
    <script src="src/js/naming.js"></script>
    <script src="src/js/reactions.js"></script>
    <script src="src/js/reactions-database.js"></script>
    <script src="src/js/mechanism-renderer.js"></script>
    <script src="src/js/layout-engine.js"></script>
    <script src="src/js/renderer.js"></script>
    <script src="src/js/undo-redo.js"></script>
    <script src="src/js/selection.js"></script>
    <script src="src/js/smart-chain-tool.js"></script>
    <script src="src/js/keyboard-shortcuts.js"></script>
    <script src="src/js/learning-manager.js"></script>
    <script src="src/js/pubchem-service.js"></script>
    <script src="src/js/mechanism-workspace.js"></script>
    <script src="src/js/molecule-library.js"></script>
    <script src="src/js/reaction-validator.js"></script>
    <script src="src/js/reaction-engine.js"></script>
    <script src="src/js/reaction-manager.js"></script>
    <script src="src/js/reaction-ui.js"></script>
    <script src="src/js/main.js"></script>
</body>
</html>
