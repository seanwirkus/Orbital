<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Orbital - Organic Chemistry Simulator</title>
    <link rel="stylesheet" href="src/css/styles.css">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <h1>‚öõÔ∏è Orbital</h1>
            <p class="subtitle">All-in-One Organic Chemistry Simulator</p>
        </header>

        <!-- Main Content Area -->
        <div class="main-content">
            <!-- Toolbar (Persistent) -->
            <aside class="toolbar">
                <h3>Drawing Tools</h3>
                
                <!-- Element Selector -->
                <div class="tool-section">
                    <h4>Elements</h4>
                    <div class="element-grid">
                        <button class="element-btn active" data-element="C">C</button>
                        <button class="element-btn" data-element="H">H</button>
                        <button class="element-btn" data-element="N">N</button>
                        <button class="element-btn" data-element="O">O</button>
                        <button class="element-btn" data-element="F">F</button>
                        <button class="element-btn" data-element="Cl">Cl</button>
                        <button class="element-btn" data-element="Br">Br</button>
                        <button class="element-btn" data-element="I">I</button>
                        <button class="element-btn" data-element="S">S</button>
                        <button class="element-btn" data-element="P">P</button>
                    </div>
                </div>

                <!-- Bond Type Selector -->
                <div class="tool-section">
                    <h4>Bond Type</h4>
                    <div class="bond-controls">
                        <button class="bond-btn active" data-bond="1">Single</button>
                        <button class="bond-btn" data-bond="2">Double</button>
                        <button class="bond-btn" data-bond="3">Triple</button>
                    </div>
                </div>

                <!-- Ring Templates -->
                <div class="tool-section">
                    <h4>Templates</h4>
                    <button class="action-btn" id="add-benzene">‚¨° Benzene</button>
                    <button class="action-btn" id="add-cyclohexane">‚¨¢ Cyclohexane</button>
                    <button class="action-btn" id="add-cyclopentane">‚¨† Cyclopentane</button>
                </div>

                <!-- Quick Actions -->
                <div class="tool-section">
                    <h4>Actions</h4>
                    <button class="action-btn" id="auto-organize">ü™Ñ Organize</button>
                    <button class="action-btn" id="clear-canvas">üóëÔ∏è Clear</button>
                </div>
            </aside>

            <!-- Main Work Area with Tabs -->
            <main class="main-work-area">
                <!-- Tab Navigation -->
                <div class="tab-navigation">
                    <button class="tab-btn active" onclick="switchTab('draw')">
                        ‚úèÔ∏è Draw
                    </button>
                    <button class="tab-btn" onclick="switchTab('simulate')">
                        üß™ Simulate Reaction
                    </button>
                    <button class="tab-btn" onclick="switchTab('mechanisms')">
                        üìä Learn Mechanisms
                    </button>
                </div>
                
                <!-- Tab Content -->
                <div class="tab-content-container">
                    <!-- DRAW TAB -->
                    <div id="draw-tab" class="tab-pane active">
                        <div class="draw-layout">
                            <div class="canvas-section">
                                <canvas id="molecule-canvas" width="800" height="600"></canvas>
                                <div class="canvas-hint">
                                    <p>üí° Click to place atoms ‚Ä¢ Drag between atoms to create bonds</p>
                                </div>
                            </div>
                            <div class="properties-sidebar">
                                <h3>Molecule Properties</h3>
                                <div class="prop-card">
                                    <div class="prop-row">
                                        <span class="prop-label">Name:</span>
                                        <span class="prop-value" id="mol-name">-</span>
                                    </div>
                                    <div class="prop-row">
                                        <span class="prop-label">Formula:</span>
                                        <span class="prop-value" id="mol-formula">-</span>
                                    </div>
                                    <div class="prop-row">
                                        <span class="prop-label">MW:</span>
                                        <span class="prop-value" id="mol-mw">-</span>
                                    </div>
                                    <div class="prop-row">
                                        <span class="prop-label">Atoms:</span>
                                        <span class="prop-value" id="mol-atoms">0</span>
                                    </div>
                                </div>
                                
                                <button class="btn-action-primary" onclick="moveToSimulation()">
                                    üß™ Use in Reaction ‚Üí
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- SIMULATE TAB -->
                    <div id="simulate-tab" class="tab-pane">
                        <div class="simulate-layout">
                            <!-- Left: Reactant Canvas -->
                            <div class="reactant-panel">
                                <div class="panel-header">
                                    <h3>1Ô∏è‚É£ Draw Reactant(s)</h3>
                                    <span class="step-badge">Step 1</span>
                                </div>
                                <canvas id="reactant-canvas" width="600" height="400"></canvas>
                                <div class="reactant-controls">
                                    <button class="btn-primary" id="save-reactant-btn" onclick="saveReactant()">
                                        ‚úÖ Save Reactant
                                    </button>
                                    <button class="btn-secondary" onclick="clearReactantCanvas()">Clear</button>
                                </div>
                                
                                <!-- Saved Reactants List -->
                                <div class="saved-reactants" id="saved-reactants">
                                    <h4>Reactants Added:</h4>
                                    <div id="reactants-list" class="mol-chips-container">
                                        <span class="empty-state">No reactants yet</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Middle: Reagent Selection + Arrow -->
                            <div class="reagent-panel">
                                <div class="panel-header">
                                    <h3>2Ô∏è‚É£ Choose Reagent</h3>
                                    <span class="step-badge">Step 2</span>
                                </div>
                                
                                <div class="reagent-selector">
                                    <label>Select Reagent:</label>
                                    <select id="reagent-select" class="reagent-dropdown" onchange="showReagentInfo()">
                                        <option value="">-- Select Reagent --</option>
                                    </select>
                                    
                                    <!-- Live Reagent Info Card -->
                                    <div id="reagent-info-card" class="reagent-info-card" style="display:none;">
                                        <div class="card-header">
                                            <strong id="reagent-name-display"></strong>
                                            <span class="reagent-badge" id="reagent-type-badge"></span>
                                        </div>
                                        <div class="card-body">
                                            <div class="info-line">
                                                <span class="icon">‚Üí</span>
                                                <span id="reagent-use-display"></span>
                                            </div>
                                            <div class="info-line">
                                                <span class="icon">‚öóÔ∏è</span>
                                                <span id="reagent-conditions-display"></span>
                                            </div>
                                            <div class="info-line">
                                                <span class="icon">üî¨</span>
                                                <span id="reagent-mechanism-display"></span>
                                            </div>
                                        </div>
                                        <button class="btn-link-small" onclick="jumpToMechanism()">
                                            View detailed mechanism ‚Üí
                                        </button>
                                    </div>
                                    
                                    <label>Conditions:</label>
                                    <select id="condition-select" class="reagent-dropdown">
                                        <option value="">None</option>
                                    </select>
                                </div>
                                
                                <!-- Big Arrow -->
                                <div class="reaction-arrow-visual">
                                    <div class="arrow-line"></div>
                                    <div class="arrow-head">‚Üí</div>
                                    <div class="arrow-label" id="arrow-reagent-label">Add reagent</div>
                                </div>
                            </div>
                            
                            <!-- Right: Product -->
                            <div class="product-panel">
                                <div class="panel-header">
                                    <h3>3Ô∏è‚É£ Product</h3>
                                    <span class="step-badge">Step 3</span>
                                </div>
                                
                                <div class="product-options">
                                    <button class="btn-predict" onclick="autoPredict()" id="predict-btn" disabled>
                                        üîÆ Auto-Predict Product
                                    </button>
                                    <span class="or-divider">OR</span>
                                    <button class="btn-manual" onclick="manualProduct()" id="manual-btn">
                                        ‚úèÔ∏è Draw Manually
                                    </button>
                                </div>
                                
                                <canvas id="product-canvas" width="600" height="400"></canvas>
                                
                                <div class="product-info" id="product-info" style="display:none;">
                                    <div class="info-card">
                                        <p><strong>Formula:</strong> <span id="product-formula">-</span></p>
                                        <p><strong>Name:</strong> <span id="product-name">-</span></p>
                                    </div>
                                </div>
                                
                                <!-- Export Options -->
                                <div class="export-section" id="export-section" style="display:none;">
                                    <h4>Complete Reaction:</h4>
                                    <div class="reaction-summary" id="reaction-summary"></div>
                                    <div class="export-buttons">
                                        <button class="btn-primary" onclick="exportReactionImage()">üì∏ Export Image</button>
                                        <button class="btn-secondary" onclick="exportReactionText()">üìÑ Export Text</button>
                                        <button class="btn-secondary" onclick="resetReaction()">üîÑ New Reaction</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- MECHANISMS TAB -->
                    <div id="mechanisms-tab" class="tab-pane">
                        <div class="mechanisms-layout">
                            <!-- Sidebar with mechanism list -->
                            <div class="mechanisms-sidebar">
                                <div class="search-box">
                                    <input type="text" placeholder="üîç Search mechanisms..." id="mech-search">
                                </div>
                                
                                <div class="mech-category">
                                    <h4>‚ö° Elimination</h4>
                                    <button class="mech-btn" onclick="loadMechanism('e2_elimination')">E2 Elimination</button>
                                    <button class="mech-btn" onclick="loadMechanism('e1_elimination')">E1 Elimination</button>
                                </div>
                                
                                <div class="mech-category">
                                    <h4>üîÑ Substitution</h4>
                                    <button class="mech-btn" onclick="loadMechanism('sn2_substitution')">SN2 Substitution</button>
                                    <button class="mech-btn" onclick="loadMechanism('sn1_substitution')">SN1 Substitution</button>
                                </div>
                                
                                <div class="mech-category">
                                    <h4>‚ûï Addition</h4>
                                    <button class="mech-btn" onclick="loadMechanism('electrophilic_addition')">Electrophilic Addition</button>
                                </div>
                                
                                <div class="mech-category">
                                    <h4>üî• Oxidation/Reduction</h4>
                                    <button class="mech-btn" onclick="loadMechanism('alcohol_oxidation_primary')">1¬∞ Alcohol Oxidation</button>
                                    <button class="mech-btn" onclick="loadMechanism('alcohol_oxidation_secondary')">2¬∞ Alcohol Oxidation</button>
                                    <button class="mech-btn" onclick="loadMechanism('carbonyl_reduction')">Carbonyl Reduction</button>
                                </div>
                                
                                <div class="mech-category">
                                    <h4>üß¨ Advanced</h4>
                                    <button class="mech-btn" onclick="loadMechanism('aldol_condensation')">Aldol Condensation</button>
                                    <button class="mech-btn" onclick="loadMechanism('grob_fragmentation')">Grob Fragmentation</button>
                                    <button class="mech-btn" onclick="loadMechanism('ester_hydrolysis_base')">Ester Hydrolysis</button>
                                </div>
                            </div>
                            
                            <!-- Main mechanism display -->
                            <div class="mechanism-display-area">
                                <div class="mech-header">
                                    <h2 id="mech-title">Select a mechanism to begin</h2>
                                    <div class="mech-controls">
                                        <button class="btn-icon" onclick="playAnimation()" title="Play Animation">‚ñ∂Ô∏è</button>
                                        <button class="btn-icon" onclick="exportSVG()" title="Export">üíæ</button>
                                    </div>
                                </div>
                                
                                <div id="mechanism-canvas-container" class="mech-canvas">
                                    <p class="placeholder">
                                        üëà Select a mechanism from the sidebar to view the step-by-step arrow-pushing mechanism
                                    </p>
                                </div>
                                
                                <div id="mech-description" class="mech-description" style="display:none;">
                                    <h3>How it works:</h3>
                                    <div id="mech-steps-list"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <p>Orbital v2.0 - All-in-One Chemistry Simulator | <a href="#" onclick="showHelp()">Help</a> | <a href="#" onclick="showAbout()">About</a></p>
        </footer>
    </div>

    <!-- JavaScript -->
    <script>
        console.log('HTML loaded');
        window.onerror = function(msg, url, lineNo, columnNo, error) {
            console.error('Global error:', msg, 'at', url, ':', lineNo);
            return false;
        };
    </script>
    <script src="src/js/elements.js"></script>
    <script src="src/js/geometry.js"></script>
    <script src="src/js/molecule.js"></script>
    <script src="src/js/naming.js"></script>
    <script src="src/js/reactions.js"></script>
    <script src="src/js/reactions-database.js"></script>
    <script src="src/js/mechanism-renderer.js"></script>
    <script src="src/js/renderer.js"></script>
    <script src="src/js/main.js"></script>
</body>
</html>
