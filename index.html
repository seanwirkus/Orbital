<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Orbital - Organic Chemistry Simulator</title>
    <link rel="stylesheet" href="src/css/styles.css">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <h1>‚öõÔ∏è Orbital</h1>
                <p class="subtitle">All-in-One Organic Chemistry Simulator</p>
            </div>
        </header>

        <!-- Main Content Area -->
        <div class="main-content">
            <!-- Left Sidebar - Tools -->
            <aside class="sidebar">
                <div class="sidebar-section">
                    <h3 class="sidebar-title">Tools</h3>
                    
                    <!-- Element Selector -->
                    <div class="tool-group">
                        <label class="tool-group-label">Elements</label>
                        <div class="element-grid">
                            <!-- Row 1: Most Common -->
                            <button class="element-btn active" data-element="C" title="Carbon">C</button>
                            <button class="element-btn" data-element="H" title="Hydrogen">H</button>
                            <button class="element-btn" data-element="N" title="Nitrogen">N</button>
                            <button class="element-btn" data-element="O" title="Oxygen">O</button>
                            <button class="element-btn" data-element="F" title="Fluorine">F</button>
                            <!-- Row 2: Halogens & Common -->
                            <button class="element-btn" data-element="Cl" title="Chlorine">Cl</button>
                            <button class="element-btn" data-element="Br" title="Bromine">Br</button>
                            <button class="element-btn" data-element="I" title="Iodine">I</button>
                            <button class="element-btn" data-element="S" title="Sulfur">S</button>
                            <button class="element-btn" data-element="P" title="Phosphorus">P</button>
                            <!-- Row 3: Additional Common -->
                            <button class="element-btn" data-element="B" title="Boron">B</button>
                            <button class="element-btn" data-element="Si" title="Silicon">Si</button>
                            <button class="element-btn" data-element="Se" title="Selenium">Se</button>
                            <button class="element-btn" data-element="As" title="Arsenic">As</button>
                            <button class="element-btn" data-element="Li" title="Lithium">Li</button>
                            <!-- Row 4: Metals -->
                            <button class="element-btn" data-element="Na" title="Sodium">Na</button>
                            <button class="element-btn" data-element="K" title="Potassium">K</button>
                            <button class="element-btn" data-element="Mg" title="Magnesium">Mg</button>
                            <button class="element-btn" data-element="Ca" title="Calcium">Ca</button>
                            <button class="element-btn" data-element="Al" title="Aluminum">Al</button>
                            <!-- Row 5: Transition Metals -->
                            <button class="element-btn" data-element="Fe" title="Iron">Fe</button>
                            <button class="element-btn" data-element="Cu" title="Copper">Cu</button>
                            <button class="element-btn" data-element="Zn" title="Zinc">Zn</button>
                        </div>
                    </div>

                    <!-- Bond Type Selector -->
                    <div class="tool-group">
                        <label class="tool-group-label">Bond Type</label>
                        <div class="bond-controls">
                            <button class="bond-btn active" data-bond="1" id="sidebar-bond-single" title="Single Bond">‚îÅ</button>
                            <button class="bond-btn" data-bond="2" id="sidebar-bond-double" title="Double Bond">‚ïê</button>
                            <button class="bond-btn" data-bond="3" id="sidebar-bond-triple" title="Triple Bond">‚â°</button>
                        </div>
                    </div>

                    <!-- Ring Templates -->
                    <div class="tool-group">
                        <label class="tool-group-label">Templates</label>
                        <div class="template-grid">
                            <button class="template-btn" id="add-benzene" title="Benzene Ring">‚¨°</button>
                            <button class="template-btn" id="add-cyclohexane" title="Cyclohexane">‚¨¢</button>
                            <button class="template-btn" id="add-cyclopentane" title="Cyclopentane">‚¨†</button>
                        </div>
                    </div>

                    <!-- Display Options -->
                    <div class="tool-group">
                        <label class="tool-group-label">Display</label>
                        <div class="checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="show-implicit-h" checked>
                                <span>Show Implicit H</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="show-lone-pairs">
                                <span>Show Lone Pairs</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="show-charges">
                                <span>Show Charges</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="show-hybridization">
                                <span>Show Hybridization</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- Quick Actions -->
                    <div class="tool-group">
                        <label class="tool-group-label">Actions</label>
                        <div class="action-buttons">
                            <button class="action-btn" id="auto-organize" title="Auto-organize molecule">ü™Ñ Organize</button>
                            <button class="action-btn" id="clear-canvas" title="Clear canvas">üóëÔ∏è Clear</button>
                        </div>
                    </div>
                </div>
            </aside>

            <!-- Main Work Area -->
            <main class="work-area">
                <!-- Tab Navigation -->
                <nav class="tab-navigation">
                    <button class="tab-btn active" data-tab="draw" onclick="switchTab('draw')">
                        <span class="tab-icon">‚úèÔ∏è</span>
                        <span class="tab-label">Draw</span>
                    </button>
                    <button class="tab-btn" data-tab="simulate" onclick="switchTab('simulate')">
                        <span class="tab-icon">üß™</span>
                        <span class="tab-label">Simulate</span>
                    </button>
                    <button class="tab-btn" data-tab="mechanisms" onclick="switchTab('mechanisms')">
                        <span class="tab-icon">üìä</span>
                        <span class="tab-label">Mechanisms</span>
                    </button>
                </nav>
                
                <!-- Tab Content -->
                <div class="tab-content">
                    <!-- DRAW TAB -->
                    <div id="draw-tab" class="tab-pane active">
                        <!-- Drawing Toolbar -->
                        <div class="drawing-toolbar">
                            <div class="toolbar-group">
                                <span class="toolbar-label">Tools:</span>
                                <div class="tool-btn-group">
                                    <button class="tool-btn active" id="tool-atom" title="Place Atoms (A)">
                                        <span class="tool-icon">‚öõÔ∏è</span>
                                        <span>Atom</span>
                                    </button>
                                    <button class="tool-btn" id="tool-bond" title="Draw Bonds (B)">
                                        <span class="tool-icon">‚îÅ</span>
                                        <span>Bond</span>
                                    </button>
                                    <button class="tool-btn" id="tool-chain" title="Chain Drawing (C)">
                                        <span class="tool-icon">„Ä∞Ô∏è</span>
                                        <span>Chain</span>
                                    </button>
                                    <button class="tool-btn" id="tool-erase" title="Eraser (E)">
                                        <span class="tool-icon">üóëÔ∏è</span>
                                        <span>Erase</span>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="toolbar-group">
                                <span class="toolbar-label">Groups:</span>
                                <div class="group-btn-group">
                                    <button class="group-btn" id="group-oh" title="Hydroxyl">OH</button>
                                    <button class="group-btn" id="group-nh2" title="Amino">NH‚ÇÇ</button>
                                    <button class="group-btn" id="group-cooh" title="Carboxyl">COOH</button>
                                    <button class="group-btn" id="group-cho" title="Aldehyde">CHO</button>
                                </div>
                            </div>
                            
                            <div class="toolbar-group">
                                <span class="toolbar-label">Options:</span>
                                <div class="option-btn-group">
                                    <button class="option-btn active" id="option-snap" title="Snap to Angles">
                                        <span class="tool-icon">üìê</span>
                                    </button>
                                    <button class="option-btn active" id="option-preview" title="Ghost Preview">
                                        <span class="tool-icon">üëª</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Canvas Area -->
                        <div class="canvas-container">
                            <div class="canvas-wrapper">
                                <canvas id="molecule-canvas" width="800" height="600"></canvas>
                            </div>
                            
                            <!-- Properties Panel -->
                            <aside class="properties-panel">
                                <h3 class="panel-title">Molecule Properties</h3>
                                <div class="properties-card">
                                    <div class="property-item">
                                        <span class="property-label">Name:</span>
                                        <span class="property-value" id="mol-name">-</span>
                                    </div>
                                    <div class="property-item">
                                        <span class="property-label">Formula:</span>
                                        <span class="property-value" id="mol-formula">-</span>
                                    </div>
                                    <div class="property-item">
                                        <span class="property-label">MW:</span>
                                        <span class="property-value" id="mol-mw">-</span>
                                    </div>
                                    <div class="property-item">
                                        <span class="property-label">Atoms:</span>
                                        <span class="property-value" id="mol-atoms">0</span>
                                    </div>
                                </div>
                                
                                <button class="btn-primary" onclick="moveToSimulation()" id="use-in-reaction-btn">
                                    <span>üß™</span>
                                    <span>Use in Reaction</span>
                                </button>
                            </aside>
                        </div>
                    </div>
                    
                    <!-- SIMULATE TAB -->
                    <div id="simulate-tab" class="tab-pane">
                        <!-- Reaction Manager UI -->
                        <div id="reaction-ui-container" class="reaction-ui-wrapper"></div>

                        <!-- Learning Notebook -->
                        <div class="learning-section">
                            <div class="learning-header">
                                <h3>üß† Learning Notebook</h3>
                                <p>Capture custom reaction challenges so Orbital can learn alongside you.</p>
                            </div>

                            <form id="learning-form" class="learning-form">
                                <div class="form-group">
                                    <label for="learning-problem">Problem prompt</label>
                                    <textarea id="learning-problem" placeholder="Describe the reaction scenario or exam-style question" required></textarea>
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="learning-reagent">Key reagents (optional)</label>
                                        <input type="text" id="learning-reagent" placeholder="e.g., Br‚ÇÇ, hv, peroxide">
                                    </div>
                                    <div class="form-group">
                                        <label for="learning-solution">Expected outcome</label>
                                        <textarea id="learning-solution" placeholder="Summarize the product or transformation" required></textarea>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label for="learning-insight">Key insight / takeaway</label>
                                    <textarea id="learning-insight" placeholder="What principle should Orbital remember?"></textarea>
                                </div>

                                <button type="submit" class="btn-primary">üíæ Save to notebook</button>
                            </form>

                            <div id="learning-suggestions" class="learning-suggestions"></div>
                            <div id="learning-entries" class="learning-entries"></div>
                        </div>
                    </div>

                    <!-- MECHANISMS TAB -->
                    <div id="mechanisms-tab" class="tab-pane">
                        <div class="mechanisms-container">
                            <!-- Mechanism Sidebar -->
                            <aside class="mechanisms-sidebar">
                                <div class="search-box">
                                    <input type="text" placeholder="üîç Search mechanisms..." id="mech-search">
                                </div>
                                
                                <div class="mech-category">
                                    <h4>‚ö° Elimination</h4>
                                    <button class="mech-btn" onclick="loadMechanism('e2_elimination')">E2 Elimination</button>
                                    <button class="mech-btn" onclick="loadMechanism('e1_elimination')">E1 Elimination</button>
                                </div>
                                
                                <div class="mech-category">
                                    <h4>üîÑ Substitution</h4>
                                    <button class="mech-btn" onclick="loadMechanism('sn2_substitution')">SN2 Substitution</button>
                                    <button class="mech-btn" onclick="loadMechanism('sn1_substitution')">SN1 Substitution</button>
                                </div>
                                
                                <div class="mech-category">
                                    <h4>‚ûï Addition</h4>
                                    <button class="mech-btn" onclick="loadMechanism('electrophilic_addition')">Electrophilic Addition</button>
                                </div>
                                
                                <div class="mech-category">
                                    <h4>üî• Oxidation/Reduction</h4>
                                    <button class="mech-btn" onclick="loadMechanism('alcohol_oxidation_primary')">1¬∞ Alcohol Oxidation</button>
                                    <button class="mech-btn" onclick="loadMechanism('alcohol_oxidation_secondary')">2¬∞ Alcohol Oxidation</button>
                                    <button class="mech-btn" onclick="loadMechanism('carbonyl_reduction')">Carbonyl Reduction</button>
                                </div>
                                
                                <div class="mech-category">
                                    <h4>üß¨ Advanced</h4>
                                    <button class="mech-btn" onclick="loadMechanism('aldol_condensation')">Aldol Condensation</button>
                                    <button class="mech-btn" onclick="loadMechanism('grob_fragmentation')">Grob Fragmentation</button>
                                    <button class="mech-btn" onclick="loadMechanism('ester_hydrolysis_base')">Ester Hydrolysis</button>
                                </div>
                            </aside>
                            
                            <!-- Mechanism Display -->
                            <div class="mechanism-display">
                                <div class="mechanism-header">
                                    <h2 id="mech-title">Select a mechanism to begin</h2>
                                    <div class="mechanism-controls">
                                        <button class="btn-icon" onclick="playAnimation()" title="Play Animation">‚ñ∂Ô∏è</button>
                                        <button class="btn-icon" onclick="exportSVG()" title="Export">üíæ</button>
                                    </div>
                                </div>
                                
                                <div id="mechanism-canvas-container" class="mechanism-canvas">
                                    <p class="placeholder-text">
                                        üëà Select a mechanism from the sidebar to view the step-by-step arrow-pushing mechanism
                                    </p>
                                </div>
                                
                                <div id="mech-description" class="mechanism-description" style="display:none;">
                                    <h3>How it works:</h3>
                                    <div id="mech-steps-list"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <p>Orbital v2.0 - All-in-One Chemistry Simulator | <a href="#" onclick="showHelp()">Help</a> | <a href="#" onclick="showAbout()">About</a></p>
        </footer>
    </div>

    <!-- JavaScript -->
    <script>
        console.log('üöÄ Orbital HTML loaded');
        window.onerror = function(msg, url, lineNo, columnNo, error) {
            console.error('‚ùå Global error:', msg, 'at', url, ':', lineNo);
            return false;
        };
    </script>
    <script src="src/js/elements.js"></script>
    <script src="src/js/periodic-table-loader.js"></script>
    <script src="src/js/geometry.js"></script>
    <script src="src/js/chemistry-intelligence.js"></script>
    <script src="src/js/smart-chemistry-logic.js"></script>
    <script src="src/js/smart-drawing.js"></script>
    <script src="src/js/clipboard.js"></script>
    <script src="src/js/molecule.js"></script>
    <script src="src/js/naming.js"></script>
    <script src="src/js/reactions.js"></script>
    <script src="src/js/reactions-database.js"></script>
    <script src="src/js/mechanism-renderer.js"></script>
    <script src="src/js/layout-engine.js"></script>
    <script src="src/js/renderer.js"></script>
    <script src="src/js/undo-redo.js"></script>
    <script src="src/js/selection.js"></script>
    <script src="src/js/smart-chain-tool.js"></script>
    <script src="src/js/keyboard-shortcuts.js"></script>
    <script src="src/js/learning-manager.js"></script>
    <script src="src/js/pubchem-service.js"></script>
    <script src="src/js/molecule-library.js"></script>
    <script src="src/js/reaction-validator.js"></script>
    <script src="src/js/reaction-engine.js"></script>
    <script src="src/js/reaction-manager.js"></script>
    <script src="src/js/reaction-ui.js"></script>
    <script src="src/js/main.js"></script>
</body>
</html>
