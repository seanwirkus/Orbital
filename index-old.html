<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Orbital - Organic Chemistry Visualizer</title>
    <link rel="stylesheet" href="src/css/styles.css">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <h1>‚öõÔ∏è Orbital</h1>
            <p class="subtitle">Organic Chemistry Visualizer and Simulator</p>
        </header>

        <!-- Main Content Area -->
        <div class="main-content">
            <!-- Toolbar -->
            <aside class="toolbar">
                <h3>Tools</h3>
                
                <!-- Element Selector -->
                <div class="tool-section">
                    <h4>Elements</h4>
                    <div class="element-grid">
                        <button class="element-btn active" data-element="C">C</button>
                        <button class="element-btn" data-element="H">H</button>
                        <button class="element-btn" data-element="N">N</button>
                        <button class="element-btn" data-element="O">O</button>
                        <button class="element-btn" data-element="F">F</button>
                        <button class="element-btn" data-element="Cl">Cl</button>
                        <button class="element-btn" data-element="Br">Br</button>
                        <button class="element-btn" data-element="I">I</button>
                        <button class="element-btn" data-element="S">S</button>
                        <button class="element-btn" data-element="P">P</button>
                    </div>
                </div>

                <!-- Bond Type Selector -->
                <div class="tool-section">
                    <h4>Bond Type</h4>
                    <div class="bond-controls">
                        <button class="bond-btn active" data-bond="1">Single</button>
                        <button class="bond-btn" data-bond="2">Double</button>
                        <button class="bond-btn" data-bond="3">Triple</button>
                    </div>
                </div>

                <!-- Drawing Tools -->
                <div class="tool-section">
                    <h4>Actions</h4>
                    <button class="action-btn" id="select-tool">Select</button>
                    <button class="action-btn" id="delete-tool">Delete</button>
                    <button class="action-btn" id="auto-organize">ü™Ñ Auto Organize</button>
                    <button class="action-btn" id="clear-canvas">Clear All</button>
                </div>

                <!-- Ring Templates -->
                <div class="tool-section">
                    <h4>Ring Templates</h4>
                    <button class="action-btn" id="add-benzene">‚¨° Benzene</button>
                    <button class="action-btn" id="add-cyclohexane">‚¨¢ Cyclohexane</button>
                    <button class="action-btn" id="add-cyclopentane">‚¨† Cyclopentane</button>
                </div>
                
                <!-- Reaction Tools -->
                <div class="tool-section">
                    <h4>‚öóÔ∏è Reactions</h4>
                    <button class="action-btn" onclick="openReactionModal()">üß™ Simulate Reaction</button>
                    <button class="action-btn" onclick="openMechanismViewer()">üìä View Mechanisms</button>
                </div>

                <!-- View Controls -->
                <div class="tool-section">
                    <h4>View</h4>
                    <label>
                        <input type="checkbox" id="show-lone-pairs" checked>
                        Show Lone Pairs
                    </label>
                    <label>
                        <input type="checkbox" id="show-charges" checked>
                        Show Charges
                    </label>
                    <label>
                        <input type="checkbox" id="show-hybridization">
                        Show Hybridization
                    </label>
                </div>
            </aside>

            <!-- Canvas Area -->
            <main class="canvas-container">
                <canvas id="molecule-canvas"></canvas>
                <div class="canvas-info">
                    <p>Click to place atoms | Click and drag between atoms to create bonds</p>
                </div>
            </main>

            <!-- Properties Panel -->
            <aside class="properties-panel">
                <h3>Properties</h3>
                
                <div class="property-section">
                    <h4>Molecule Info</h4>
                    <div id="molecule-info">
                        <p><strong>Name:</strong> <span id="molecule-name">-</span></p>
                        <p><strong>Formula:</strong> <span id="formula">-</span></p>
                        <p><strong>MW:</strong> <span id="molecular-weight">-</span></p>
                        <p><strong>Atoms:</strong> <span id="atom-count">0</span></p>
                        <p><strong>Bonds:</strong> <span id="bond-count">0</span></p>
                    </div>
                </div>

                <div class="property-section">
                    <h4>Selected Atom</h4>
                    <div id="atom-properties">
                        <p><strong>Element:</strong> <span id="selected-element">-</span></p>
                        <p><strong>Hybridization:</strong> <span id="selected-hybrid">-</span></p>
                        <p><strong>Charge:</strong> <span id="selected-charge">-</span></p>
                        <p><strong>Bonds:</strong> <span id="selected-bonds">-</span></p>
                    </div>
                </div>

                <div class="property-section">
                    <h4>Actions</h4>
                    <button class="action-btn full-width" id="save-molecule">Save</button>
                    <button class="action-btn full-width" id="load-molecule">Load</button>
                    <button class="action-btn full-width" id="export-image">Export Image</button>
                </div>

                <div class="property-section">
                    <h4>‚öóÔ∏è Reactions</h4>
                    <button class="action-btn full-width" id="start-reactant1">Draw Reactant 1</button>
                    <button class="action-btn full-width" id="start-reactant2">Draw Reactant 2</button>
                    <button class="action-btn full-width" id="start-product">Draw Product</button>
                    <button class="action-btn full-width" id="view-reaction">View Reaction</button>
                    <button class="action-btn full-width" id="clear-reaction">Clear Reaction</button>
                    <div id="reaction-status" style="margin-top: 0.5rem; font-size: 0.8rem; color: #666;"></div>
                </div>
            </aside>
        </div>

        <!-- Reaction Viewer Modal -->
                <!-- Reaction Modal -->
        <div id="reactionModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Reaction Simulator</h2>
                    <button onclick="closeReactionModal()" class="close-btn">&times;</button>
                </div>
                
                <div class="modal-body">
                    <div class="reaction-workflow">
                        <div class="workflow-step">
                            <h3>Step 1: Draw Reactant 1</h3>
                            <button id="startReactant1Btn" class="btn-primary" onclick="startDrawingReactant(1)">
                                Start Drawing Reactant 1
                            </button>
                            <button id="saveReactant1Btn" class="btn-success" onclick="saveReactant(1)" style="display:none;">
                                Save Reactant 1
                            </button>
                        </div>
                        
                        <div class="workflow-step">
                            <h3>Step 2: Draw Reactant 2 (Optional)</h3>
                            <button id="startReactant2Btn" class="btn-primary" onclick="startDrawingReactant(2)" disabled>
                                Start Drawing Reactant 2
                            </button>
                            <button id="saveReactant2Btn" class="btn-success" onclick="saveReactant(2)" style="display:none;">
                                Save Reactant 2
                            </button>
                            <button id="skipReactant2Btn" class="btn-secondary" onclick="skipReactant2()" disabled>
                                Skip (Single Reactant)
                            </button>
                        </div>
                        
                        <div class="workflow-step">
                            <h3>Step 3: Select Reagents & Conditions</h3>
                            <label for="reagentSelect">Reagent:</label>
                            <select id="reagentSelect" onchange="updateReagentInfo()" disabled>
                                <option value="">None</option>
                            </select>
                            
                            <!-- Reagent information display -->
                            <div id="reagentInfo" class="reagent-info" style="display:none;">
                                <div class="reagent-details">
                                    <strong class="reagent-name"></strong>
                                    <div class="reagent-use"></div>
                                    <div class="reagent-conditions"></div>
                                    <div class="reagent-mechanism"></div>
                                </div>
                            </div>
                            
                            <label for="conditionSelect">Additional Conditions:</label>
                            <select id="conditionSelect" disabled>
                                <option value="">None</option>
                            </select>
                        </div>
                        
                        <div class="workflow-step">
                            <h3>Step 4: Draw Product</h3>
                            <button id="startProductBtn" class="btn-primary" onclick="startDrawingProduct()" disabled>
                                Start Drawing Product
                            </button>
                            <button id="saveProductBtn" class="btn-success" onclick="saveProduct()" style="display:none;">
                                Save Product
                            </button>
                        </div>
                    </div>
                    
                    <div class="reaction-display">
                        <h3>Current Reaction:</h3>
                        <div id="reactionDisplay" class="reaction-equation">
                            <div class="empty-state">Draw reactants to begin</div>
                        </div>
                    </div>
                    
                    <div class="reaction-info" id="reactionInfo"></div>
                </div>
                
                <div class="modal-footer">
                    <button onclick="clearReaction()" class="btn-secondary">Clear Reaction</button>
                    <button onclick="exportReaction()" class="btn-primary" id="exportReactionBtn" disabled>Export Reaction</button>
                </div>
            </div>
        </div>
        
        <!-- Mechanism Viewer Modal -->
        <div id="mechanismModal" class="modal">
            <div class="modal-content mechanism-modal-content">
                <div class="modal-header">
                    <h2>üìä Reaction Mechanism Viewer</h2>
                    <button onclick="closeMechanismModal()" class="close-btn">&times;</button>
                </div>
                
                <div class="modal-body">
                    <div class="mechanism-selector">
                        <h3>Select a Reaction Mechanism:</h3>
                        <div class="mechanism-grid">
                            <button class="mechanism-card" onclick="viewMechanism('e2_elimination')">
                                <h4>E2 Elimination</h4>
                                <p>Strong base ‚Üí Alkene</p>
                                <span class="reaction-type">Elimination</span>
                            </button>
                            
                            <button class="mechanism-card" onclick="viewMechanism('e1_elimination')">
                                <h4>E1 Elimination</h4>
                                <p>Acid/Heat ‚Üí Alkene</p>
                                <span class="reaction-type">Elimination</span>
                            </button>
                            
                            <button class="mechanism-card" onclick="viewMechanism('sn2_substitution')">
                                <h4>SN2 Substitution</h4>
                                <p>Nucleophile ‚Üí Inversion</p>
                                <span class="reaction-type">Substitution</span>
                            </button>
                            
                            <button class="mechanism-card" onclick="viewMechanism('sn1_substitution')">
                                <h4>SN1 Substitution</h4>
                                <p>Carbocation ‚Üí Racemization</p>
                                <span class="reaction-type">Substitution</span>
                            </button>
                            
                            <button class="mechanism-card" onclick="viewMechanism('electrophilic_addition')">
                                <h4>Electrophilic Addition</h4>
                                <p>H-X or X‚ÇÇ ‚Üí Addition</p>
                                <span class="reaction-type">Addition</span>
                            </button>
                            
                            <button class="mechanism-card" onclick="viewMechanism('alcohol_oxidation_primary')">
                                <h4>1¬∞ Alcohol Oxidation</h4>
                                <p>Oxidant ‚Üí Carboxylic Acid</p>
                                <span class="reaction-type oxidation">Oxidation</span>
                            </button>
                            
                            <button class="mechanism-card" onclick="viewMechanism('alcohol_oxidation_secondary')">
                                <h4>2¬∞ Alcohol Oxidation</h4>
                                <p>Oxidant ‚Üí Ketone</p>
                                <span class="reaction-type oxidation">Oxidation</span>
                            </button>
                            
                            <button class="mechanism-card" onclick="viewMechanism('carbonyl_reduction')">
                                <h4>Carbonyl Reduction</h4>
                                <p>Hydride ‚Üí Alcohol</p>
                                <span class="reaction-type reduction">Reduction</span>
                            </button>
                            
                            <button class="mechanism-card" onclick="viewMechanism('aldol_condensation')">
                                <h4>Aldol Condensation</h4>
                                <p>Base ‚Üí Œ±,Œ≤-Unsaturated</p>
                                <span class="reaction-type">Condensation</span>
                            </button>
                            
                            <button class="mechanism-card" onclick="viewMechanism('grob_fragmentation')">
                                <h4>Grob Fragmentation</h4>
                                <p>Base ‚Üí Ring Contraction</p>
                                <span class="reaction-type">Fragmentation</span>
                            </button>
                            
                            <button class="mechanism-card" onclick="viewMechanism('ester_hydrolysis_base')">
                                <h4>Ester Hydrolysis</h4>
                                <p>Base ‚Üí Carboxylate</p>
                                <span class="reaction-type">Acyl Substitution</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="mechanism-display" id="mechanismDisplay">
                        <p class="mechanism-placeholder">Select a reaction mechanism above to view the step-by-step mechanism with electron flow arrows</p>
                    </div>
                    
                    <div class="mechanism-controls" id="mechanismControls" style="display: none;">
                        <button class="btn-primary" onclick="mechanismRenderer.playAnimation()">‚ñ∂Ô∏è Play Animation</button>
                        <button class="btn-secondary" onclick="mechanismRenderer.exportSVG()">üíæ Export SVG</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <p>Orbital v1.0 - Interactive Organic Chemistry Visualizer</p>
        </footer>
    </div>

    <!-- JavaScript -->
    <script src="src/js/elements.js"></script>
    <script src="src/js/molecule.js"></script>
    <script src="src/js/naming.js"></script>
    <script src="src/js/reactions.js"></script>
    <script src="src/js/reactions-database.js"></script>
    <script src="src/js/mechanism-renderer.js"></script>
    <script src="src/js/renderer.js"></script>
    <script src="src/js/main.js"></script>
</body>
</html>
